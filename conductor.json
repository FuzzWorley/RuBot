{
  "api-key": "$CONDUCTOR_API_KEY",
  "enable-db": false,
  "app-json": {
    "id": "/$GROUP/$SERVICE",
    "cpus": 0.1,
    "mem": 64,
    "instances": 1,
    "constraints": [["hostname", "UNIQUE"], ["az", "GROUP_BY", "3"]],
    "env": {
      "SERVICE_3000_NAME": "rubot",
      "SLACK_TOKEN": "$SLACK_TOKEN",
      "DB_HOST": "{{ db_host }}",
      "DB_NAME": "{{ db_name }}",
      "DB_PASSWORD": "{{ db_password }}",
      "DB_PORT": "{{ db_port }}",
      "DB_USER": "{{ db_user }}",
    },
    "container": {
      "type": "DOCKER",
      "docker": {
        "image": "$ORG/$SERVICE:$VERSION",
        "network": "BRIDGE",
        "parameters": [
          {
            "key": "log-driver",
            "value": "syslog"
          },
          {
            "key": "log-opt",
            "value": "syslog-address=tcp://logstash.service.consul:5544"
          },
          {
            "key": "log-opt",
            "value": "syslog-tag=$SERVICE"
          }
        ],
        "portMappings": [
          { "containerPort": 3000, "protocol": "tcp" }
        ]
      }
    },
    "uris": [
      "http://marathon.service.consul:8080/v2/artifacts/etc/.dockercfg"
    ],
    "healthChecks": [
      {
        "path": "/",
        "protocol": "HTTP",
        "gracePeriodSeconds": 5,
        "intervalSeconds": 20,
        "timeoutSeconds": 10,
        "maxConsecutiveFailures": 3
      }
    ],
    "upgradeStrategy": {
       "minimumHealthCapacity": 1,
       "maximumOverCapacity": 0
    }
  }
}
